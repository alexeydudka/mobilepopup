!function(a){var b={ajax:"",html:"",targetblock:"",width:"",height:"",closehtml:'<a href="" class="button-close close"></a>',loadinghtml:'<div class="loader-wrap"><div class="loader"><span></span><span></span><span></span></div></div>',customclass:"",onloaded:function(a){return!0},onclosed:function(a){return!0},onformsubmited:function(a,b){return!0}},c=b,d="mobilepopup",e="mobilepopup-overflow",f="mobilepopup-outer",g="mobilepopup-inner",h=a(window),i=popupoverflow=popupouter=popupinner="",j={init:function(d){var e={};c=a.extend(e,b,d),currenttopposition=a("body").scrollTop(),k(),l(),m(),i.addClass("open"),a("body").addClass("mobilepopup-opened")},reload:function(b){c=a.extend(c,b),i.attr("class",d+" "+c.customclass+" open loading"),l(),m()},resize:function(b){c=a.extend(c,b),l()},close:function(){i.removeClass("open"),a("body").removeClass("mobilepopup-opened"),popupinner.html(""),c.onclosed(i)}},k=function(){0==a("."+d).length&&(a("body").append("<div class='"+d+" "+c.customclass+" disabled-animation-in-child loading'><div class='"+e+"'></div><div class='"+f+"'><div class='"+g+"'></div>"+c.closehtml+c.loadinghtml+"</div></div>"),i=a("."+d),popupoverflow=a("."+e),popupinner=a("."+g),popupouter=a("."+f),o())},l=function(){var b="";""!=a.trim(c.width)&&(b+="width:"+c.width+";"),""!=a.trim(c.height)&&(b+="height:"+c.height+";"),popupouter.attr("style",b),n()},m=function(){""!=a.trim(c.ajax)&&a.post(c.ajax,function(a){popupinner.html(a),i.removeClass("loading"),c.onloaded(i)}),""==a.trim(c.html)&&""==a.trim(c.targetblock)||(popupinner.html(""!=a.trim(c.html)?c.html:a(c.targetblock).find(">*").clone()),i.removeClass("loading"),c.onloaded(i))},n=function(){popupouter.css({"max-width":h.innerWidth()+"px","max-height":h.innerHeight()+"px"})},o=function(){popupoverflow.on("click",function(){return j.close(),!1}),i.on("click",".close",function(){return j.close(),!1}),i.on("click",".submit-popup-form",function(){var b=i.find(".popup-form");return i.addClass("loading"),a.post(b.attr("action")+"?"+b.serialize(),function(a){c.onformsubmited(a,i),i.removeClass("loading")}),!1}),h.on("orientationchange resize",function(){n()})};a.mobilepopup=function(b,c){return j[b]?j[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" not found for mobilepopup"):j.init.apply(this,arguments)}}(jQuery);